req.params.file = 'eastere.gg%00.md' servePublicFiles()(req, res, next) expect(res.sendFile).to.have.been.calledWith(sinon.match(/ftp[/\\]eastere\.gg/)) expect(challenges.easterEggLevelOneChallenge.solved).to.equal(true) }) it('should solve "forgottenDevBackupChallenge" when requesting package.json.bak with Poison Null Byte attack', () => { challenges.forgottenDevBackupChallenge = { solved: false, save } as unknown as Challenge req.params.file = 'package.json.bak%00.md'